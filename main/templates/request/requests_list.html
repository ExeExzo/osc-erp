{% load static %}
<!DOCTYPE html>
<html>
<head>
    <title>–ó–∞–ø—Ä–æ—Å—ã –Ω–∞ –ø–æ–∫—É–ø–∫—É</title>
    <link rel="stylesheet" href="{% static 'main/css/requests_list.css' %}">
</head>
<body>

    <br>
    <a href="/user/profile/">‚¨Ö –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ –ø—Ä–æ—Ñ–∏–ª—é</a>
    <br>

    <h1>üìã –ó–∞–ø—Ä–æ—Å—ã –Ω–∞ –ø–æ–∫—É–ø–∫—É</h1>

    <!-- –§–∏–ª—å—Ç—Ä –ø–æ —Å—Ç–∞—Ç—É—Å—É -->
    <form method="get" style="margin-bottom:12px;">
        <label for="status-select">–§–∏–ª—å—Ç—Ä –ø–æ —Å—Ç–∞—Ç—É—Å—É:</label>
        <select id="status-select" name="status">
            <option value="">–í—Å–µ</option>
            {% for val,label in statuses %}
                <option value="{{ val }}" {% if selected_status == val %}selected{% endif %}>{{ label }}</option>
            {% endfor %}
        </select>
        <button type="submit">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
        {% if selected_status %}
            <a href="{% url 'requests_list' %}" style="margin-left:8px;">–°–±—Ä–æ—Å–∏—Ç—å</a>
        {% endif %}
    </form>

    {% for r in requests %}
    <div class="card">

        <div class="header">
            <b>–°–æ–∑–¥–∞—Ç–µ–ª—å:</b> {{ r.creator }} |
            <b>–†–û:</b> {{ r.ro_number }} |
            <b>–°—Ç–∞—Ç—É—Å:</b> {{ r.status }} |
            <b>–ü–æ—Å—Ç–∞–≤—â–∏–∫:</b> {{ r.supplier }} |
            <b>–ü–æ–∫—É–ø–∞—Ç–µ–ª—å:</b> {{ r.customer }}
        </div>

        <div>
            <b>–°—É–º–º–∞:</b> {{ r.amount_without_vat }} ‚Üí {{ r.amount_with_vat }} <br>
            <b>–î–µ–¥–ª–∞–π–Ω:</b> {{ r.ddl }} <br>
            <b>–ö–æ–º–º–µ–Ω—Ç:</b> {{ r.comment }}
        </div>

        <h4>üßæ –ü—Ä–µ–¥–º–µ—Ç—ã:</h4>
        <ul>
            {% for item in r.items.all %}
            <li>
                {{ item.name }} ‚Äî {{ item.quantity }} x {{ item.price }} = {{ item.total }}
            </li>
            {% endfor %}
        </ul>

        <div class="actions">
            <a href="{% url 'change_request_status' r.id 'APPROVED' %}" class="btn approve">–û–¥–æ–±—Ä–∏—Ç—å</a>
            <a href="{% url 'change_request_status' r.id 'REJECTED' %}" class="btn reject">–û—Ç–∫–ª–æ–Ω—è—Ç—å</a>
            <a href="{% url 'change_request_status' r.id 'PAID' %}" class="btn paid">–û–ø–ª–∞—Ç–∏—Ç—å</a>
            <a href="{% url 'change_request_status' r.id 'CANCELLED' %}" class="btn cancel">–û—Ç–º–µ–Ω–∏—Ç—å</a>
        </div>

    </div>
    {% empty %}
    <p>No requests.</p>
    {% endfor %}

</body>
</html>
